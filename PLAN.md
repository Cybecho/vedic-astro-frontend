## 정적 웹페이지 구축 계획서: 베다 점성술 프론트엔드

### 프로젝트 개요

본 프로젝트는 API Gateway와 통신하는 정적 웹페이지를 구축하여 사용자가 웹 인터페이스를 통해 베다 점성술 서비스를 이용할 수 있도록 하는 것입니다. 사용자는 생년월일과 위치 정보를 입력하고, 개발자는 커스텀 프롬프트를 설정할 수 있습니다.

### 구현 목표

사용자가 직관적인 웹 인터페이스를 통해 점성술 정보를 입력하고, API Gateway를 통해 처리된 결과를 확인할 수 있는 정적 웹페이지를 구축합니다. 개발자를 위한 프롬프트 커스터마이징 기능과 성능 모니터링 정보도 함께 제공합니다.

### 기술 스택 선정

정적 웹페이지 구축을 위해 다음 기술 스택을 선택합니다:
- **HTML/CSS/JavaScript**: 순수 바닐라 JavaScript로 구현하여 별도의 빌드 과정 없이 간단하게 배포
- **웹 서버**: Nginx (가볍고 정적 파일 서빙에 최적화)
- **배포**: Docker 컨테이너

프레임워크 없이 구현하는 이유는 단순한 폼 제출과 결과 표시만 필요하므로, 복잡한 프레임워크가 불필요하기 때문입니다.

### 데이터 형식 참고사항

계획서에서 언급되는 `.txt` 확장자 파일들은 실제로 텍스트 파일을 사용하라는 의미가 아닙니다. 이는 실제 네트워크상에서 오고갈 데이터의 형식을 보여주는 참조용입니다. 실제 구현에서는 JSON 형식의 데이터가 HTTP 프로토콜을 통해 전송됩니다.

### UI 구조 및 기능

#### 입력 폼 구성

1. **생년월일 입력**: 연도, 월, 일을 각각 입력할 수 있는 폼
2. **태어난 시간 입력**: 시간과 분을 입력할 수 있는 폼
3. **위치 선택**: 드롭다운 메뉴로 국가와 도시 선택
   - 주요 국가와 대표 도시를 하드코딩
   - 선택 시 자동으로 위도/경도 값 설정
4. **프롬프트 입력**: 텍스트 영역으로 커스텀 프롬프트 입력 (선택사항)
5. **성능 정보 표시**: 응답 시간과 토큰 사용량 표시 (읽기 전용)
6. **결과 출력**: 대형 텍스트 영역으로 AI 해석 결과 표시

#### 로딩 애니메이션

API 호출 중에는 전체 화면을 덮는 반투명 검은색 오버레이와 회전하는 로딩 스피너를 표시합니다.

### 백엔드 서비스 수정 사항

#### call-gemini-api 서비스 수정

기존 서비스에 다음 기능을 추가해야 합니다:

1. **커스텀 프롬프트 지원**: 요청에 프롬프트가 포함된 경우, 기본 `post-prompt.txt` 대신 사용
2. **토큰 사용량 추적**: Gemini API 응답에서 토큰 사용량 정보 추출
3. **응답 시간 측정**: 요청 처리 시작부터 완료까지의 시간 기록

수정된 응답 형식:
```json
{
  "interpretation": "AI 해석 결과...",
  "token_usage": {
    "prompt_tokens": 1234,
    "completion_tokens": 5678,
    "total_tokens": 6912
  },
  "processing_time": "2.34s"
}
```

#### API Gateway 서비스 수정

Gateway도 다음과 같이 수정이 필요합니다:

1. **프롬프트 전달**: 프론트엔드에서 받은 커스텀 프롬프트를 AI 서비스로 전달
2. **메타데이터 전달**: 토큰 사용량과 처리 시간 정보를 프론트엔드로 전달
3. **CORS 설정**: 웹 브라우저에서의 요청을 허용하도록 CORS 헤더 추가

### 개발 프로세스

#### 1단계: HTML 구조 구현

기본 HTML 파일을 생성하고 폼 요소들을 배치합니다. 시맨틱 HTML을 사용하여 접근성을 고려하되, 디자인은 최소한으로 유지합니다.

#### 2단계: 위치 데이터 하드코딩

전 세계 주요 국가와 도시의 위도/경도 정보를 JavaScript 객체로 정의합니다. 국가 선택 시 해당 국가의 도시 목록이 동적으로 업데이트되도록 구현합니다.

#### 3단계: API 통신 구현

Fetch API를 사용하여 API Gateway와 통신하는 로직을 구현합니다. 입력 데이터를 JSON 형식으로 변환하고, 응답을 파싱하여 화면에 표시합니다.

#### 4단계: 로딩 상태 관리

API 호출 시작 시 로딩 오버레이를 표시하고, 응답 수신 또는 오류 발생 시 숨기는 로직을 구현합니다. CSS 애니메이션으로 스피너 회전 효과를 추가합니다.

#### 5단계: 백엔드 서비스 수정

call-gemini-api와 API Gateway 서비스를 수정하여 커스텀 프롬프트와 메타데이터를 지원하도록 업데이트합니다.

#### 6단계: Docker 컨테이너화

Nginx 기반의 Dockerfile을 작성하여 정적 파일을 서빙하는 웹 서버를 구축합니다. 최소한의 설정으로 80번 포트에서 서비스를 제공하도록 구성합니다.

### 프로젝트 구조

```
vedic-astro-frontend/
├── index.html          # 메인 HTML 파일
├── style.css           # 최소한의 스타일
├── script.js           # API 통신 및 UI 로직
├── Dockerfile          # Nginx 기반 컨테이너
└── nginx.conf          # Nginx 설정
```

### 보안 및 성능 고려사항

- API Gateway URL을 환경 변수로 설정 가능하도록 구성
- 입력 값 검증을 클라이언트와 서버 모두에서 수행
- 에러 처리를 통해 사용자에게 명확한 피드백 제공

### 확장 가능성

현재는 기능 구현에 집중하되, 향후 다음과 같은 개선이 가능하도록 구조를 설계합니다:
- UI/UX 디자인 개선
- 다국어 지원
- 결과 저장 및 공유 기능
- 반응형 디자인 적용
